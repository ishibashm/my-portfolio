# GCP VMインスタンスへのSSH接続手順

このドキュメントは、Google Cloud Platform (GCP) 上で稼働しているVMインスタンス（このプロジェクトではWordPressサーバー）にSSH接続するための手順を記載したものである。

## 方法1：ブラウザ経由での接続（簡易版）

1.  **GCPコンソールにログイン**:
    -   [https://console.cloud.google.com/](https://console.cloud.google.com/) にアクセスし、Googleアカウントでログインする。

2.  **対象プロジェクトの選択**:
    -   画面上部のプロジェクト選択メニューから、WordPressをデプロイしたプロジェクト（例: `blog-471319`）を選択する。

3.  **VMインスタンス画面への移動**:
    -   左上のナビゲーションメニュー（ハンバーガーメニュー `☰`）を開く。
    -   メニューをスクロールし、「**Compute Engine**」セクションを見つけてクリックする。
    -   サブメニューから「**VMインスタンス**」を選択する。

4.  **SSH接続の開始**:
    -   インスタンスの一覧が表示される。
    -   対象のインスタンス（例: `wordpress-1-vm`）の行を探す。
    -   その行の右側にある「**接続**」列の「**SSH**」というリンクをクリックする。

5.  **ブラウザベースのターミナル起動**:
    -   クリック後、新しいブラウザウィンドウまたはタブがポップアップで開く。
    -   黒い画面にコマンドが入力できる状態になれば、接続成功。

---

## 方法2：ローカルのターミナルソフトからの接続（推奨）

Tera TermやWindows Terminal、PowerShellなど、ローカルの使い慣れたターミナルから接続するための設定。

### ステップ1：SSHキーペアの作成

まず、ローカルPCでSSH接続に使うための「鍵」を作成します。

1.  **PowerShellを開く**:
    -   Windowsのスタートメニューで「PowerShell」と検索し、起動する。

2.  **SSHキーを作成するコマンドを実行**:
    -   以下のコマンドを実行する。`your_username` の部分は、あなたのPCのユーザー名などに置き換えてください。
    ```powershell
    ssh-keygen -t rsa -f ~/.ssh/gcp_rsa -C your_username
    ```
    -   `Enter passphrase` と2回聞かれますが、何も入力せずに `Enter` キーを押して進めて問題ありません。

3.  **キーの生成を確認**:
    -   これにより、`C:\Users\your_username\.ssh\` フォルダに以下の2つのファイルが作成されます。
        -   `gcp_rsa`: **秘密鍵**（絶対に他人に渡さないでください）
        -   `gcp_rsa.pub`: **公開鍵**（これをサーバーに登録します）

### ステップ2：公開鍵をGCPに登録

次に、作成した公開鍵の中身をGCPのVMインスタンスに登録します。

1.  **公開鍵の中身をコピー**:
    -   PowerShellで以下のコマンドを実行し、公開鍵の中身を表示します。
    ```powershell
    cat ~/.ssh/gcp_rsa.pub
    ```
    -   表示された `ssh-rsa AAAA...` から始まる文字列全体を、マウスで選択してコピーします。

2.  **GCPコンソールでメタデータを開く**:
    -   GCPコンソールの「Compute Engine」>「VMインスタンス」画面に移動します。
    -   インスタンス名（`wordpress-1-vm`）をクリックして、詳細画面を開きます。
    -   画面上部の「**編集**」をクリックします。

3.  **SSHキーを貼り付け**:
    -   「**SSH認証鍵**」というセクションを探します。（「表示して編集」などのリンクをクリックする必要があるかもしれません）
    -   「**項目を追加**」をクリックすると、新しい入力ボックスが表示されます。
    -   そのボックスに、先ほどコピーした**公開鍵の中身**（`ssh-rsa AAAA...`）を貼り付けます。
    -   キーが貼り付けられると、右側にユーザー名（`-C` で指定した `your_username`）が自動で表示されます。

4.  **保存**:
    -   画面下部の「**保存**」をクリックします。

### ステップ3：Tera Termなどで接続

1.  **Tera Termを起動**し、「新しい接続」を開きます。
2.  **ホスト**: `35.224.211.72` を入力します。
3.  **サービス**: `SSH` を選択し、「OK」をクリックします。
4.  **SSH認証画面**:
    -   **ユーザー名**: `your_username`（ステップ1で `-C` オプションで指定した名前）を入力します。
    -   **認証方式**: 「RSA/DSA/ECDSA/ED25519鍵を使う」を選択します。
    -   **秘密鍵**: 「...」ボタンをクリックし、ステップ1で作成した**秘密鍵**ファイル `C:\Users\your_username\.ssh\gcp_rsa` を選択します。
    -   「OK」をクリックします。

これで、ローカルのターミナルからGCPのVMインスタンスに接続できるはずです。

---

## 接続後の基本的なコマンド例

-   **Bitnamiサービスのステータス確認:**
    ```bash
    sudo /opt/bitnami/ctlscript.sh status
    ```

-   **Apacheサーバーの再起動:**
    ```bash
    sudo /opt/bitnami/ctlscript.sh restart apache